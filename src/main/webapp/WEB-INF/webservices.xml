<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:security="http://www.springframework.org/schema/security"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jaxrs="http://cxf.apache.org/jaxrs"
       xmlns:jaxws="http://cxf.apache.org/jaxws" xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans.xsd
http://cxf.apache.org/jaxrs
http://cxf.apache.org/schemas/jaxrs.xsd
http://cxf.apache.org/jaxws
http://cxf.apache.org/schemas/jaxws.xsd
http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context.xsd
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <import resource="classpath:META-INF/cxf/cxf.xml"/>
    <import resource="classpath:META-INF/cxf/cxf-extension-soap.xml"/>
    <import resource="classpath:META-INF/cxf/cxf-servlet.xml"/>

    <context:component-scan base-package="cz.zcu.kiv.eegdatabase.webservices"/>
    <security:global-method-security secured-annotations="enabled" />

    <jaxws:endpoint id="clientService"
                       implementor="#clientDataService"
                       address="/ClientService">
           <jaxws:properties>
               <entry key="mtom-enabled" value="true"/>
           </jaxws:properties>
       </jaxws:endpoint>


    <jaxws:endpoint id="userDataService"
                    implementor="#userData"
                    address="/UserDataService">
        <jaxws:properties>
            <entry key="mtom-enabled" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>

    <jaxws:endpoint id="semanticService"
                    implementor="#semanticDataService"
                    address="/SemanticService">
        <jaxws:properties>
            <entry key="mtom-enabled" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>

    <bean id="userData" class="cz.zcu.kiv.eegdatabase.webservices.dataDownload.UserDataImpl">
        <property name="personDao" ref="personDao"/>
        <property name="experimentDao" ref="experimentDao"/>
        <property name="scenarioDao" ref="scenarioDao"/>
        <property name="weatherDao" ref="weatherDao"/>
        <property name="researchGroupDao" ref="researchGroupDao"/>
        <property name="hardwareDao" ref="hardwareDao"/>
        <property name="dataFileDao" ref="dataFileDao"/>
        <property name="digitizationDao" ref="digitizationDao"/>
        <property name="subjectGroupDao" ref="subjectGroupDao"/>
        <property name="artifactDao" ref="artifactDao"/>
        <property name="electrodeConfDao" ref="electrodeConfDao"/>
    </bean>

    <bean id="semanticDataService" class="cz.zcu.kiv.eegdatabase.webservices.semantic.SemanticServiceImpl">
        <property name="simpleSemanticFactory" ref="semanticFactory"/>
    </bean>

    <bean id="clientDataService" class="cz.zcu.kiv.eegdatabase.webservices.client.ClientServiceImpl" autowire="byType">
        <property name="personDao" ref="personDao"/>
        <property name="researchGroupDao" ref="researchGroupDao"/>
        <property name="hardwareDao" ref="hardwareDao"/>
        <property name="weatherDao" ref="weatherDao"/>
        <property name="educationLevelDao" ref="educationLevelDao"/>
        <property name="scenarioSchemasDao" ref="scenarioSchemasDao"/>
        <property name="scenarioDao" ref="scenarioDao"/>
        <property name="dataFileDao" ref="dataFileDao"/>
        <property name="experimentDao" ref="experimentDao"/>
        <property name="personOptParamDefDao" ref="personOptParamDefDao"/>
        <property name="personOptParamValDao" ref="personOptParamValDao"/>
        <property name="experimentOptParamValDao" ref="experimentOptParamValDao"/>
        <property name="fileMetadataParamValDao" ref="fileMetadataDao"/>
        <property name="experimentOptParamDefDao" ref="experimentOptParamDefDao"/>
        <property name="fileMetadataParamDefDao" ref="fileMetadataParamDefDao"/>
        <property name="researchGroupMembershipDao" ref="researchGroupMembershipDao"/>
    </bean>


    <jaxrs:server id="restContainer" address="/reservation">
        <jaxrs:providers>
            <bean class="cz.zcu.kiv.eegdatabase.webservices.reservation.utils.SecurityExceptionMapper"/>
            <bean class="cz.zcu.kiv.eegdatabase.webservices.reservation.utils.ReservationExceptionMapper"/>
        </jaxrs:providers>
        <jaxrs:serviceBeans>
            <bean class="cz.zcu.kiv.eegdatabase.webservices.reservation.ReservationServiceImpl"/>
        </jaxrs:serviceBeans>
      </jaxrs:server>
</beans>
